import{u as m,a as h,r,j as i,L as g}from"./index-C05QhGEP.js";import{a as k}from"./axios-B4uVmeYG.js";import{A as x}from"./api-CigzIjai.js";const j=({Component:c,allowedRoles:o})=>{const e=m(),d=h(),[u,f]=r.useState(!1);return r.useEffect(()=>{const a=localStorage.getItem("token");if(!a){e("/login");return}const l=async()=>{try{const{apiKey:t}=x,s=await k.post(`${t}/verify-token`,{},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}});s.data.code!==200?n():p(s.data.role)}catch(t){console.error("Token verification failed",t),n()}},n=()=>{localStorage.removeItem("token"),e("/login")},p=t=>{if(!o.includes(t)){e(t==="admin"?"/":"/agent/agentLeads");return}f(!0)};l()},[e,d,o]),u?i.jsx(c,{}):i.jsx(g,{})};export{j as default};
