import{r,u as b,j as e}from"./index-C05QhGEP.js";import{b as M}from"./apiServices-BLiMT9Yd.js";import{I as V}from"./index-By0aXpWG.js";import{S as A,T as D,G as N}from"./TaskList-B4mygb29.js";import{G as R}from"./iconBase-DrVbEGxc.js";import{l as T}from"./index-CGwCSIWv.js";import{A as H}from"./api-CigzIjai.js";import"./axios-B4uVmeYG.js";import"./Socket-BAmX9CkN.js";import"./Serializer-D5ddTVbr.js";import"./DefaultPropsProvider-CK6xLYnL.js";import"./generateUtilityClasses-C5UaBTEU.js";import"./List-Tf7OrP3l.js";import"./createBox-DKObizbn.js";import"./Button-D9YPwSqa.js";import"./assertThisInitialized-C91vtUtA.js";import"./useSlotProps-C1ZMSFiR.js";import"./TextField-CqwtIWC_.js";import"./createSvgIcon-DJsEsuGB.js";function E(n){return R({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M2 2h12l1 1v10l-1 1H2l-1-1V3l1-1zm0 11h12V3H2v10zm11-9H3v3h10V4zm-1 2H4V5h8v1zm-3 6h4V8H9v4zm1-3h2v2h-2V9zM7 8H3v1h4V8zm-4 3h4v1H3v-1z"},child:[]}]})(n)}const st=()=>{const[n,m]=r.useState([]),i=localStorage.getItem("agentId"),d=localStorage.getItem("token"),u=b(),[g,p]=r.useState(!1),[x,v]=r.useState(""),o=r.useRef(null),{apiKey:f}=H,j=localStorage.getItem("agentId");r.useEffect(()=>(o.current||(o.current=T(f),o.current.on("receive_message",t=>{const s=t.length>0?t[0].agentId:null;!t.message&&s==j&&m(w=>{const a=[...w];return console.log(t),t.forEach(c=>{const h=a.findIndex(z=>z.id===c.id);h===-1?a.push(c):a[h]=c}),a})}),o.current.on("connect_error",t=>{console.error("WebSocket connection error:",t)})),()=>{o.current&&(o.current.disconnect(),o.current=null)}),[f]),r.useEffect(()=>{(async()=>{try{const s=await M("get-assign-tasks",d,i);m(s)}catch(s){console.log("Error fetching tasks:",s)}})()},[i,d]);const l=r.useMemo(()=>n.reduce((t,s)=>(t[s.taskNo]||(t[s.taskNo]={tasks:[],status:new Set}),t[s.taskNo].tasks.push(s),t[s.taskNo].status.add(s.status),t),{}),[n]),k=t=>{u(`/agent/tasksCSV/${i}/${t}`)},I={progress:"#FFC107",complete:"#03C04A"},C=t=>{const s=Array.from(t)[0];return I[s]},y=t=>{v(t),p(!0)},S=()=>{p(!1)};return e.jsxs("div",{style:{width:"100%",height:"100%",padding:"30px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center"},children:[e.jsx(V,{size:20,onClick:()=>u(-1),style:{cursor:"pointer",marginRight:"10px"}}),e.jsx("span",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#1640D6"},children:"All Tasks:"})]}),e.jsx(A,{})]}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("div",{className:"task-list",children:Object.keys(l).map(t=>e.jsxs("div",{className:"task-item",style:{backgroundColor:C(l[t].status)},children:[e.jsx("span",{className:"task-number",onClick:()=>k(t),children:`Task No: ${t}`}),Array.from(l[t].status)[0]==="complete"&&e.jsx(D,{title:"Review",PopperProps:{sx:{"& .MuiTooltip-tooltip":{marginTop:"25px"}}},children:e.jsx("span",{onClick:()=>y(t),className:"review-icon",children:e.jsx(E,{color:"white",size:25,style:{cursor:"pointer"}})})})]},t))}),e.jsx(N,{open:g,onClose:S,taskNo:x})]})};export{st as default};
